<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>单词消消乐</title>
    <style>
        /* 全局样式：可爱华丽基调，柔色、圆角、阴影、渐变 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", "幼圆", sans-serif;
        }
        body {
            background: linear-gradient(135deg, #fef6fb, #eef5ff);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* 标题样式：可编辑，可爱华丽，阴影+渐变文字 */
        #gameTitle {
            text-align: center;
            font-size: 48px;
            font-weight: bold;
            background: linear-gradient(90deg, #ff69b4, #9370db, #32cd32);
            -webkit-background-clip: text;
            color: transparent;
            text-shadow: 0 2px 10px rgba(255,105,180,0.3);
            margin: 20px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        #gameTitle:hover {
            transform: scale(1.05);
            text-shadow: 0 4px 15px rgba(255,105,180,0.5);
        }
        #gameTitle:focus {
            outline: none;
            background: linear-gradient(90deg, #ff477e, #800080, #22c55e);
            -webkit-background-clip: text;
        }

        /* 菜单区域：圆角卡片，阴影，内边距 */
        .menu-bar {
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            padding: 25px;
            display: flex;
            align-items: center;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        /* 滑块容器：可爱样式 */
        .slider-wrap {
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 250px;
        }
        .slider-wrap label {
            font-size: 18px;
            color: #666;
            font-weight: 500;
        }
        #wordCountSlider {
            -webkit-appearance: none;
            width: 100%;
            height: 10px;
            border-radius: 5px;
            background: linear-gradient(90deg, #ffb6c1, #dda0dd);
            outline: none;
        }
        #wordCountSlider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: #fff;
            border: 3px solid #ff69b4;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(255,105,180,0.4);
            transition: all 0.2s ease;
        }
        #wordCountSlider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            border-color: #ff477e;
        }
        #sliderValue {
            font-size: 18px;
            font-weight: bold;
            color: #ff69b4;
            min-width: 40px;
            text-align: center;
        }
        /* 按钮通用样式：可爱华丽，渐变+圆角+阴影 */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 30px;
            font-size: 18px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        .btn-import {
            background: linear-gradient(90deg, #ff9a9e, #fad0c4);
            color: #000;
            margin-right: 10px;
        }
        .btn-import-txt {
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            color: #000;
        }
        .btn-start {
            background: linear-gradient(90deg, #84fab0, #8fd3f4);
            color: #000;
        }
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .btn:active {
            transform: translateY(0);
        }
        input[type="file"] {
            display: none;
        }

        /* 耗时显示：圆角卡片，居中 */
        .time-cost {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            color: #666;
            background: #fff;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 30px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
        }
        .time-cost span {
            color: #ff69b4;
            text-shadow: 0 1px 3px rgba(255,105,180,0.2);
        }

        /* 单词面板：居中，自动换行，间距优化 */
        .word-panel {
            max-width: 100%;
            margin: 0 auto;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            padding: 20px;
            background: rgba(255,255,255,0.8);
            border-radius: 20px;
            box-shadow: 0 5px 30px rgba(0,0,0,0.05);
            pointer-events: none; /* 初始锁定，开始游戏后解锁 */
        }
        .word-panel.unlock {
            pointer-events: all;
        }
        /* 单词/短语方块：自适应宽高，适配长文本，字体颜色改为黑色 */
        .word-block {
            min-width: 100px;
            min-height: 80px;
            max-width: 180px;
            padding: 10px 15px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 16px;
            font-weight: 500;
            color: #000; /* 字体颜色改为黑色 */
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.2s ease;
            word-break: break-word;
            position: relative;
            overflow: hidden;
        }
        .word-block:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
        }
        .word-block.clicked {
            border: 3px solid #fff;
            box-shadow: 0 0 15px rgba(255,255,255,0.8);
        }

        /* 动画：华丽消除动画 + 不匹配红色渐变动效 */
        @keyframes eliminate {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.8; box-shadow: 0 0 20px rgba(255,255,255,1); }
            100% { transform: scale(0); opacity: 0; }
        }
        .eliminate {
            animation: eliminate 0.6s ease forwards;
            pointer-events: none;
        }
        @keyframes mismatch {
            0% { background-color: inherit; }
            30% { background-color: #ff4444; }
            60% { background-color: #ff4444; }
            100% { background-color: inherit; }
        }
        .mismatch {
            animation: mismatch 0.5s ease forwards;
            pointer-events: none;
        }

        /* 模态框：通关提示，居中，华丽遮罩+卡片 */
        .modal-mask {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        .modal-mask.show {
            opacity: 1;
            pointer-events: all;
        }
        .modal-content {
            background: linear-gradient(135deg, #fff, #fef9ff);
            border-radius: 24px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 10px 50px rgba(0,0,0,0.2);
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }
        .modal-mask.show .modal-content {
            transform: scale(1);
        }
        .modal-title {
            font-size: 36px;
            font-weight: bold;
            color: #ff69b4;
            margin-bottom: 20px;
            text-shadow: 0 2px 8px rgba(255,105,180,0.3);
        }
        .modal-desc {
            font-size: 22px;
            color: #666;
            margin-bottom: 30px;
        }
        .modal-desc span {
            color: #ff477e;
            font-weight: bold;
            font-size: 24px;
        }
        .btn-continue {
            background: linear-gradient(90deg, #ff69b4, #9370db);
            color: #000;
        }

        /* 提示文本：导入说明 */
        .import-tip {
            font-size: 14px;
            color: #999;
            text-align: center;
            margin-top: -15px;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        /* 响应式适配：小屏幕优化短语显示 */
        @media (max-width: 992px) {
            #gameTitle {
                font-size: 36px;
            }
            .word-block {
                min-width: 80px;
                min-height: 70px;
                max-width: 150px;
                font-size: 14px;
                padding: 8px 12px;
                color: #000; /* 响应式字体黑色 */
            }
        }
        @media (max-width: 768px) {
            .menu-bar {
                flex-direction: column;
                align-items: flex-start;
            }
            .slider-wrap {
                width: 100%;
            }
            .import-btns {
                display: flex;
                gap: 10px;
                margin-top: 10px;
            }
            .btn-import, .btn-import-txt {
                padding: 10px 20px;
                font-size: 16px;
            }
            .word-block {
                min-width: 70px;
                min-height: 60px;
                max-width: 120px;
                font-size: 12px;
                padding: 6px 10px;
                color: #000; /* 手机端字体黑色 */
            }
            .modal-content {
                padding: 30px 20px;
            }
            .modal-title {
                font-size: 28px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 可编辑标题 -->
        <h1 id="gameTitle" contenteditable="true">单词消消乐</h1>

        <!-- 菜单区域：滑块+导入+开始 -->
        <div class="menu-bar">
            <div class="slider-wrap">
                <label for="wordCountSlider">短语/单词对数：</label>
                <input type="range" id="wordCountSlider" min="5" max="50" value="18">
                <span id="sliderValue">18</span>
            </div>
            <div class="import-btns">
                <label for="excelFile" class="btn btn-import">导入Excel词表</label>
                <input type="file" id="excelFile" accept=".xlsx">
                <label for="txtFile" class="btn btn-import-txt">导入TXT词表</label>
                <input type="file" id="txtFile" accept=".txt">
            </div>
            <button class="btn btn-start" id="startBtn">开始游戏</button>
        </div>
        <p class="import-tip">支持格式：1. active：活跃的 / 8. You have some moves, kid：你有两下子啊，孩子<br>自动过滤序号、兼容中英文冒号，支持短语/标点/空格，UTF-8编码</p>

        <!-- 耗时显示 -->
        <div class="time-cost">耗时：<span id="timeNum">0</span>秒</div>

        <!-- 单词/短语面板 -->
        <div class="word-panel" id="wordPanel"></div>

        <!-- 通关模态框 -->
        <div class="modal-mask" id="modalMask">
            <div class="modal-content">
                <h2 class="modal-title">挑战成功！</h2>
                <p class="modal-desc">本次耗时：<span id="modalTime">0</span>秒</p>
                <button class="btn btn-continue" id="continueBtn">继续挑战</button>
            </div>
        </div>
    </div>

    <script>
        // ---------------------- 全局变量定义 ----------------------
        let wordList = []; // 原始短语/单词二维数组 [['英文','中文'], ['短语','短句'], ...]
        let currentWordPairs = 18; // 适配18个条目，默认18对
        let startIndex = 0; // 当前取词的起始索引
        let lastClickBlock = null; // 上一次点击的方块
        let timer = null; // 计时定时器
        let timeSecond = 0; // 耗时秒数
        let isPlaying = false; // 是否正在游戏中

        // 方块背景色池（指定颜色：粉、绿、紫、橙、棕、蓝）
        const bgColors = [
            '#ffb6c1', // 粉色
            '#98fb98', // 绿色
            '#dda0dd', // 紫色
            '#ffb347', // 橙色
            '#cd853f', // 棕色
            '#87ceeb'  // 蓝色
        ];

        // ---------------------- DOM元素获取 ----------------------
        const gameTitle = document.getElementById('gameTitle');
        const wordCountSlider = document.getElementById('wordCountSlider');
        const sliderValue = document.getElementById('sliderValue');
        const excelFile = document.getElementById('excelFile');
        const txtFile = document.getElementById('txtFile');
        const startBtn = document.getElementById('startBtn');
        const timeNum = document.getElementById('timeNum');
        const wordPanel = document.getElementById('wordPanel');
        const modalMask = document.getElementById('modalMask');
        const modalTime = document.getElementById('modalTime');
        const continueBtn = document.getElementById('continueBtn');

        // ---------------------- 初始化：从localStorage加载数据 ----------------------
        init();
        function init() {
            // 加载标题
            const savedTitle = localStorage.getItem('wordGameTitle');
            if (savedTitle) gameTitle.innerText = savedTitle;
            // 加载词表/短语表
            const savedWordList = localStorage.getItem('wordGameWordList');
            if (savedWordList) {
                wordList = JSON.parse(savedWordList);
                renderWordPanel();
            }
            // 滑块初始值（适配18个条目）
            sliderValue.innerText = currentWordPairs;
        }

        // ---------------------- 标题编辑：实时保存到localStorage ----------------------
        gameTitle.addEventListener('blur', function() {
            const newTitle = this.innerText.trim() || '单词消消乐';
            this.innerText = newTitle;
            localStorage.setItem('wordGameTitle', newTitle);
        });
        gameTitle.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                this.blur();
            }
        });

        // ---------------------- 滑块事件：实时显示数值+更新面板 ----------------------
        wordCountSlider.addEventListener('input', function() {
            currentWordPairs = parseInt(this.value);
            sliderValue.innerText = currentWordPairs;
            if (wordList.length > 0) renderWordPanel();
        });

        // ---------------------- Excel导入（保留，兼容标准xlsx） ----------------------
        excelFile.addEventListener('change', async function(e) {
            const file = e.target.files[0];
            if (!file) return;
            try {
                const isXlsx = file.name.endsWith('.xlsx') && (file.type === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' || file.type === '');
                if (!isXlsx) {
                    alert('请选择标准.xlsx文件！');
                    this.value = '';
                    return;
                }
                const data = await readExcelFile(file);
                if (data.length === 0) {
                    alert('Excel无有效内容！');
                    this.value = '';
                    return;
                }
                wordList = data;
                shuffleArray(wordList);
                localStorage.setItem('wordGameWordList', JSON.stringify(wordList));
                startIndex = 0;
                renderWordPanel();
                alert(`Excel导入成功！共${data.length}对`);
                this.value = '';
            } catch (err) {
                console.error(err);
                alert('Excel解析失败，请使用TXT导入！');
                this.value = '';
            }
        });

        function readExcelFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsArrayBuffer(file);
                reader.onload = function(e) {
                    try {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array', cellText: true });
                        const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                        const json = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                        const result = json.filter(row => {
                            const w = (row[0] || '').toString().trim();
                            const a = (row[1] || '').toString().trim();
                            return w && a;
                        }).map(row => [row[0].trim(), row[1].trim()]);
                        resolve(result);
                    } catch (err) {
                        reject(err);
                    }
                };
                reader.onerror = reject;
            });
        }

        // ---------------------- 【核心终极适配】TXT导入：支持单词+短语，兼容标点/空格/长文本 ----------------------
        txtFile.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file || !file.name.endsWith('.txt')) {
                alert('请选择TXT文本文件！');
                this.value = '';
                return;
            }
            const reader = new FileReader();
            reader.readAsText(file, 'UTF-8');
            reader.onload = function(e) {
                try {
                    const content = e.target.result;
                    // 按行分割，兼容Windows/Linux换行，过滤空行
                    const lines = content.split(/\r?\n/).filter(line => line.trim());
                    const data = [];
                    let errorLineCount = 0;

                    lines.forEach((line, index) => {
                        const trimLine = line.trim();
                        // 跳过注释行（#开头）
                        if (trimLine.startsWith('#')) return;

                        // 核心正则：终极适配
                        // 支持：数字. 单词：中文 / 数字. 英文短语, 标点：中文短句，标点
                        // 自动过滤序号、保留短语/标点/空格，精准匹配冒号分隔的中英文
                        const match = trimLine.match(/^\d+[.\s、:：]*\s*(.+?)\s*[:：]\s*(.+)$/);
                        
                        if (match && match.length === 3) {
                            // 提取匹配到的内容，保留原有标点/空格，仅去首尾多余空格
                            const enContent = match[1].trim();
                            const cnContent = match[2].trim();
                            // 过滤空内容（防止冒号前后无有效文字）
                            if (enContent && cnContent) {
                                data.push([enContent, cnContent]);
                            } else {
                                errorLineCount++;
                            }
                        } else {
                            errorLineCount++;
                            console.warn(`第${index+1}行格式不匹配，已忽略：${trimLine}`);
                        }
                    });

                    if (data.length === 0) {
                        alert('TXT中无有效内容！\n请使用格式：1. 英文/短语：中文/短句（支持标点、空格）');
                        txtFile.value = '';
                        return;
                    }

                    // 保存并渲染，持久化到本地
                    wordList = data;
                    shuffleArray(wordList);
                    localStorage.setItem('wordGameWordList', JSON.stringify(wordList));
                    startIndex = 0;
                    renderWordPanel();

                    // 友好提示导入结果
                    let msg = `TXT导入成功！\n共读取${data.length}对有效内容`;
                    if (errorLineCount > 0) msg += `\n忽略${errorLineCount}行不匹配格式的内容`;
                    alert(msg);
                    txtFile.value = '';
                } catch (err) {
                    console.error('TXT解析失败：', err);
                    alert('TXT解析失败，请确保：\n1. 编码为UTF-8\n2. 格式为 数字. 英文/短语：中文/短句');
                    txtFile.value = '';
                }
            };
            reader.onerror = function() {
                alert('TXT文件读取失败，请确保文件未损坏！');
                txtFile.value = '';
            };
        });

        // ---------------------- 游戏核心逻辑 ----------------------
        startBtn.addEventListener('click', function() {
            if (wordList.length === 0) {
                alert('请先导入词表/短语表！');
                return;
            }
            shuffleArray(wordList);
            startIndex = 0;
            renderWordPanel();
            resetTimer();
            wordPanel.classList.add('unlock');
            this.innerText = '重新开始(重置内容)';
            startTimer();
            isPlaying = true;
        });

        continueBtn.addEventListener('click', function() {
            modalMask.classList.remove('show');
            startIndex += currentWordPairs * 2;
            const remain = wordList.length * 2 - startIndex;
            if (remain <= 0) {
                startIndex = 0;
                alert('内容已全部挑战，重新开始！');
            }
            renderWordPanel();
            resetTimer();
            startTimer();
            isPlaying = true;
        });

        function renderWordPanel() {
            wordPanel.innerHTML = '';
            if (wordList.length === 0) return;
            const displayContents = [];
            for (let i = 0; i < currentWordPairs; i++) {
                const idx = startIndex / 2 + i;
                if (idx >= wordList.length) break;
                displayContents.push(wordList[idx][0], wordList[idx][1]);
            }
            shuffleArray(displayContents);
            displayContents.forEach(content => {
                const block = document.createElement('div');
                block.className = 'word-block';
                block.innerText = content;
                block.style.backgroundColor = bgColors[Math.floor(Math.random() * bgColors.length)];
                block.addEventListener('click', handleBlockClick);
                wordPanel.appendChild(block);
            });
        }

        function handleBlockClick(e) {
            const currentBlock = e.target;
            if (!isPlaying || currentBlock.classList.contains('clicked') || currentBlock.classList.contains('eliminate') || currentBlock.classList.contains('mismatch')) return;
            currentBlock.classList.add('clicked');
            if (!lastClickBlock) {
                lastClickBlock = currentBlock;
                return;
            }
            const lastContent = lastClickBlock.innerText;
            const currentContent = currentBlock.innerText;
            const isMatch = wordList.some(pair => 
                (pair[0] === lastContent && pair[1] === currentContent) || 
                (pair[0] === currentContent && pair[1] === lastContent)
            );

            if (isMatch) {
                setTimeout(() => {
                    lastClickBlock.classList.add('eliminate');
                    currentBlock.classList.add('eliminate');
                    lastClickBlock.classList.remove('clicked');
                    currentBlock.classList.remove('clicked');
                    lastClickBlock = null;
                    checkAllEliminated();
                }, 200);
            } else {
                setTimeout(() => {
                    lastClickBlock.classList.add('mismatch');
                    currentBlock.classList.add('mismatch');
                    setTimeout(() => {
                        lastClickBlock.classList.remove('clicked', 'mismatch');
                        currentBlock.classList.remove('clicked', 'mismatch');
                        lastClickBlock = null;
                    }, 500);
                }, 200);
            }
        }

        function checkAllEliminated() {
            const allBlocks = document.querySelectorAll('.word-block');
            const eliminatedBlocks = document.querySelectorAll('.word-block.eliminate');
            if (allBlocks.length === eliminatedBlocks.length && isPlaying) {
                stopTimer();
                isPlaying = false;
                modalTime.innerText = timeSecond;
                setTimeout(() => modalMask.classList.add('show'), 600);
            }
        }

        function startTimer() {
            if (timer) clearInterval(timer);
            timer = setInterval(() => {
                timeSecond++;
                timeNum.innerText = timeSecond;
            }, 1000);
        }

        function stopTimer() {
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
        }

        function resetTimer() {
            stopTimer();
            timeSecond = 0;
            timeNum.innerText = 0;
        }

        function shuffleArray(arr) {
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        // XLSX解析库（保留，兼容标准Excel）
        !function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.XLSX=t():e.XLSX=t()}(this,function(){var e={},t=[];function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",t[0]=function(e,t,n){"use strict";n.r(t);var r=n(1);t.version=r.version,t.read=r.read,t.utils=n(3)},t[1]=function(e,t,n){"use strict";n.d(t,"version",function(){return o}),n.d(t,"read",function(){return i});var r="0.19.3",o=r;function i(e,t){var r={};return r.Sheets={},r.SheetNames=[],function e(t,n,r){var o,i,s=a(t),l=s.SheetNames,u=s.Sheets;r.SheetNames=l;for(var d=0;d<l.length;d++)o=l[d],i=u[o],r.Sheets[o]=i}(e,t,r),r}var a=n(2)},t[2]=function(e,t,n){"use strict";function r(e){return e}function o(e){return new Uint8Array(e)}function i(e){return e.buffer}function s(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}function a(e){var t=void 0,n=void 0;if("string"==typeof e)t=e,n="base64";else if(e instanceof ArrayBuffer)t=o(e),n="array";else if(e instanceof Uint8Array)t=e,n="array";else if("object"==typeof e&&e.length)t=o(e),n="array";else throw new Error("unsupported input");var r=XLSX.read(t,{type:n});return r}n.d(t,"read",function(){return a})},t[3]=function(e,t,n){"use strict";n.r(t);var r={};n.d(t,"sheet_to_json",function(){return o}),n.d(t,"utils",function(){return r});function o(e,t){var n=[],o={header:1,defval:""};"object"==typeof t&&(o=Object.assign({},o,t));var i=e["!ref"]?e["!ref"].split(":"):["A1","A1"],l=function(e){var t=0,n=0;for(var r=0;r<e.length;r++){var o=e.charCodeAt(r);if(o>=65&&o<=90)t=t*26+(o-64);else if(o>=48&&o<=57)n=n*10+(o-48)}return{c:t,r:n}}(i[0]),u=function(e){var t=0,n=0;for(var r=0;r<e.length;r++){var o=e.charCodeAt(r);if(o>=65&&o<=90)t=t*26+(o-64);else if(o>=48&&o<=57)n=n*10+(o-48)}return{c:t,r:n}}(i[1]);for(var d=l.r;d<=u.r;d++){var p={},f=[];for(var c in e){var m=e[c],g=function(e){var t=0,n=0;for(var r=0;r<e.length;r++){var o=e.charCodeAt(r);if(o>=65&&o<=90)t=t*26+(o-64);else if(o>=48&&o<=57)n=n*10+(o-48)}return{c:t,r:n}}(c);if(g.r!==d)continue;var v=m.v!==void 0?m.v:m.w!==void 0?m.w:o.defval;if(o.header===1)f.push(v);else{var h=g.c;if(o.header instanceof Array){var b=o.header[h-1];b&&(p[b]=v)}else p[h]=v}}o.header===1&&f.length>0&&n.push(f),o.header!==1&&Object.keys(p).length>0&&n.push(p)}return n}},t[4]=function(e,t,n){"use strict";};return n(0)});
    </script>
</body>
</html>
