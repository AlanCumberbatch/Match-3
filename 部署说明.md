# GitHub Pages 部署说明

## 已完成的配置

✅ 已创建 GitHub Actions workflow (`.github/workflows/deploy.yml`)
✅ 已配置 Vite base 路径为 `/Match-3/`
✅ 已更新 README 添加部署信息

## 启用 GitHub Pages（重要！）

要启用自动部署，需要在 GitHub 仓库设置中启用 GitHub Pages：

### 步骤：

1. 访问仓库：https://github.com/AlanCumberbatch/Match-3
2. 点击 **Settings**（设置）
3. 在左侧菜单中找到 **Pages**（页面）
4. 在 **Source**（源）部分：
   - 选择 **GitHub Actions** 作为部署源
   - 或者选择 **Deploy from a branch**，然后选择 **gh-pages** 分支（如果使用旧方式）
5. 点击 **Save**（保存）

### 使用 GitHub Actions 部署（推荐）

如果选择 GitHub Actions 作为部署源：
- 每次推送到 `main` 分支会自动触发构建和部署
- 部署完成后，网站将在以下地址可用：
  - https://alancumberbatch.github.io/Match-3/

### 验证部署

1. 推送代码后，访问 **Actions** 标签页
2. 查看 workflow 运行状态
3. 等待构建和部署完成（通常需要 1-2 分钟）
4. 访问部署地址查看网站

## Workflow 说明

### 触发条件

- 推送到 `main` 分支
- 创建 Pull Request 到 `main` 分支
- 手动触发（workflow_dispatch）

### 构建流程

1. **Checkout** - 检出代码
2. **Setup Node.js** - 设置 Node.js 环境（版本 18）
3. **Install dependencies** - 安装依赖（使用 yarn）
4. **Build** - 构建项目（`yarn build`）
5. **Upload artifact** - 上传构建产物
6. **Deploy** - 部署到 GitHub Pages

### 权限说明

Workflow 需要以下权限：
- `contents: read` - 读取仓库内容
- `pages: write` - 写入 GitHub Pages
- `id-token: write` - OIDC 令牌（用于部署）

## 故障排查

### 如果部署失败：

1. **检查 Actions 日志**
   - 访问 Actions 标签页查看详细错误信息

2. **检查 GitHub Pages 设置**
   - 确保已启用 GitHub Pages
   - 确保选择了正确的部署源

3. **检查 base 路径**
   - 确保 `vite.config.ts` 中的 base 路径正确
   - 如果仓库名不是 `Match-3`，需要修改 base 路径

4. **检查构建错误**
   - 本地运行 `yarn build` 检查是否有构建错误
   - 确保所有依赖都已正确安装

### 常见问题

**Q: 部署后页面显示 404？**
A: 检查 `vite.config.ts` 中的 base 路径是否与仓库名匹配

**Q: 构建失败？**
A: 检查 Node.js 版本和依赖是否正确安装

**Q: 如何更新部署？**
A: 只需推送到 `main` 分支，GitHub Actions 会自动重新部署

## 本地测试部署

在推送到 GitHub 之前，可以在本地测试构建：

```bash
# 安装依赖
yarn install

# 构建项目
yarn build

# 预览构建结果
yarn preview
```

构建产物在 `dist/` 目录中。

## 自定义域名（可选）

如果需要使用自定义域名：

1. 在仓库 Settings > Pages 中添加自定义域名
2. 在域名 DNS 中添加 CNAME 记录指向 `alancumberbatch.github.io`
3. 更新 `vite.config.ts` 中的 base 路径（如果需要）

---

**注意**：首次部署可能需要几分钟时间。部署完成后，网站将自动更新。
