# GitHub Pages 部署说明

## 已完成的配置

✅ 已创建 GitHub Actions workflow (`.github/workflows/deploy.yml`)
✅ 已配置 Vite base 路径为 `/Match-3/`
✅ 已更新 README 添加部署信息

## 启用 GitHub Pages（重要！）

要启用自动部署，需要在 GitHub 仓库设置中启用 GitHub Pages：

### 详细步骤：

1. **访问仓库设置页面**
   - 打开：https://github.com/AlanCumberbatch/Match-3
   - 点击仓库顶部的 **Settings**（设置）标签

2. **进入 Pages 设置**
   - 在左侧菜单栏中找到 **Pages**（页面）
   - 位置：通常在 `Code and automation`（代码和自动化）部分下

3. **配置部署源**
   - 在页面中找到 **"Build and deployment"**（构建和部署）部分
   - 找到 **"Source"**（源）下拉菜单
   - **重要**：选择 **"GitHub Actions"** 选项

4. **关于保存**
   - ⚠️ **GitHub Pages 设置是自动保存的**，选择后无需点击保存按钮
   - 选择 `GitHub Actions` 后，页面会自动保存配置
   - 如果看到配置已更新或页面刷新，说明已成功保存

5. **验证配置**
   - 选择后，页面可能会显示 "Your site is ready to be published" 或类似提示
   - 如果之前没有运行过 workflow，可能需要等待第一次部署完成

### 使用 GitHub Actions 部署（推荐）

如果选择 GitHub Actions 作为部署源：
- 每次推送到 `main` 分支会自动触发构建和部署
- 部署完成后，网站将在以下地址可用：
  - https://alancumberbatch.github.io/Match-3/

### 如果看不到保存按钮怎么办？

**这是正常的！** GitHub Pages 设置是自动保存的：

1. **选择 GitHub Actions 后会自动保存**
   - 无需点击任何保存按钮
   - 页面会自动应用设置

2. **如何确认已保存？**
   - 刷新页面，如果 Source 显示为 "GitHub Actions"，说明已保存
   - 或者访问 **Actions** 标签页，查看是否有 workflow 在运行

3. **如果选择后没有反应？**
   - 尝试刷新页面（F5 或 Cmd+R）
   - 检查浏览器控制台是否有错误
   - 确保有仓库的管理员权限

4. **手动触发部署（如果自动部署没有开始）**
   - 访问仓库的 **Actions** 标签页
   - 找到 "Build and Deploy" workflow
   - 点击 "Run workflow" 按钮手动触发

### 验证部署

1. 推送代码后，访问 **Actions** 标签页
2. 查看 workflow 运行状态
3. 等待构建和部署完成（通常需要 1-2 分钟）
4. 访问部署地址查看网站

## Workflow 说明

### 触发条件

- 推送到 `main` 分支
- 创建 Pull Request 到 `main` 分支
- 手动触发（workflow_dispatch）

### 构建流程

1. **Checkout** - 检出代码
2. **Setup Node.js** - 设置 Node.js 环境（版本 18）
3. **Install dependencies** - 安装依赖（使用 yarn）
4. **Build** - 构建项目（`yarn build`）
5. **Upload artifact** - 上传构建产物
6. **Deploy** - 部署到 GitHub Pages

### 权限说明

Workflow 需要以下权限：
- `contents: read` - 读取仓库内容
- `pages: write` - 写入 GitHub Pages
- `id-token: write` - OIDC 令牌（用于部署）

## 故障排查

### 如果部署失败：

1. **检查 Actions 日志**
   - 访问 Actions 标签页查看详细错误信息

2. **检查 GitHub Pages 设置**
   - 确保已启用 GitHub Pages
   - 确保选择了正确的部署源

3. **检查 base 路径**
   - 确保 `vite.config.ts` 中的 base 路径正确
   - 如果仓库名不是 `Match-3`，需要修改 base 路径

4. **检查构建错误**
   - 本地运行 `yarn build` 检查是否有构建错误
   - 确保所有依赖都已正确安装

### 常见问题

**Q: 部署后页面显示 404？**
A: 检查 `vite.config.ts` 中的 base 路径是否与仓库名匹配

**Q: 构建失败？**
A: 检查 Node.js 版本和依赖是否正确安装

**Q: 如何更新部署？**
A: 只需推送到 `main` 分支，GitHub Actions 会自动重新部署

## 本地测试部署

在推送到 GitHub 之前，可以在本地测试构建：

```bash
# 安装依赖
yarn install

# 构建项目
yarn build

# 预览构建结果
yarn preview
```

构建产物在 `dist/` 目录中。

## 自定义域名（可选）

如果需要使用自定义域名：

1. 在仓库 Settings > Pages 中添加自定义域名
2. 在域名 DNS 中添加 CNAME 记录指向 `alancumberbatch.github.io`
3. 更新 `vite.config.ts` 中的 base 路径（如果需要）

---

**注意**：首次部署可能需要几分钟时间。部署完成后，网站将自动更新。
